<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.549">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>~!gurí_ - Creación de documentos finales con ~!gurí_</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">~!gurí_</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Buscar"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Navegación de palanca" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Descripción</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../articles/get_started.html"> 
<span class="menu-text">Inicio rápido</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-documentación" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Documentación</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-documentación">    
        <li>
    <a class="dropdown-item" href="../articles/configuration.html">
 <span class="dropdown-text">Configuración</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/editing.html">
 <span class="dropdown-text">Uso de gurí</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/proofreading.html">
 <span class="dropdown-text">Preparación de archivos</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/customization.html">
 <span class="dropdown-text">Personalización</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../articles/doi_batch.html">
 <span class="dropdown-text">Depósito DOI</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">Acerca de</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
    <a href="https://github.com/estedeahora/guri" title="Github" class="quarto-navigation-tool px-1" aria-label="Github"><i class="bi bi-github"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Creación de documentos finales con ~!gurí_</li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../figures/guri_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">En esta página</h2>
   
  <ul>
  <li><a href="#la-creación-de-documentos-finales-y-el-rol-del-coordinador-de-producción-en-guri_" id="toc-la-creación-de-documentos-finales-y-el-rol-del-coordinador-de-producción-en-guri_" class="nav-link active" data-scroll-target="#la-creación-de-documentos-finales-y-el-rol-del-coordinador-de-producción-en-guri_">La creación de documentos finales y el rol del coordinador de producción en ~!guri_</a></li>
  <li><a href="#sec-folders" id="toc-sec-folders" class="nav-link" data-scroll-target="#sec-folders">Organización de carpetas de trabajo</a></li>
  <li><a href="#sec-metadata" id="toc-sec-metadata" class="nav-link" data-scroll-target="#sec-metadata">Metadatos</a>
  <ul class="collapse">
  <li><a href="#información-del-volumennúmero-el-archivo-_issue.yaml" id="toc-información-del-volumennúmero-el-archivo-_issue.yaml" class="nav-link" data-scroll-target="#información-del-volumennúmero-el-archivo-_issue.yaml">Información del volumen/número: el archivo <code>_issue.yaml</code></a></li>
  <li><a href="#taxonomía-credit" id="toc-taxonomía-credit" class="nav-link" data-scroll-target="#taxonomía-credit">Taxonomía CRediT</a></li>
  <li><a href="#la-información-de-los-artículos-el-archivo-art.yaml" id="toc-la-información-de-los-artículos-el-archivo-art.yaml" class="nav-link" data-scroll-target="#la-información-de-los-artículos-el-archivo-art.yaml">La información de los artículos: el archivo <code>art[~].yaml</code></a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Creación de documentos finales con ~!gurí_</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Importante
</div>
</div>
<div class="callout-body-container callout-body">
<p>Esta es una versión preliminar y en proceso de construcción. Muchos aspectos pueden cambiar drásticamente (incluso en sólo un par de días). Tenga presente este aspecto y revise siempre la que esté trabajando con última versión antes de iniciar esta etapa del trabajo editorial.</p>
</div>
</div>
<section id="la-creación-de-documentos-finales-y-el-rol-del-coordinador-de-producción-en-guri_" class="level1">
<h1>La creación de documentos finales y el rol del coordinador de producción en ~!guri_</h1>
<p><code>~!guri_</code> le permite a los editores de revistas científicas de acceso diamante automatizar la etapa de producción generando múltiples formatos de salida a partir de un manuscrito en formato <code>.docx</code>. Para ello, <code>~!guri_</code> utiliza un conjunto de reglas y plantillas que posibilitan la conversión entre formatos.</p>
<p>Para comenzar con la creación de documentos es necesario que previamente haya instalado el paquete <code>{guri}</code> y las dependencias necesarias, configurando el entorno de trabajo. Además, para poder utilizar <code>~!guri_</code> es necesario que haya creado una revista (ver <a href="articles/configuration.html">Configuración</a>)</p>
<p>Las tareas específicas del <em>Coodrdinador de producción</em> o <em>Editor de producción</em> serán:</p>
<ol type="a">
<li>Coordinar el proceso general de la etapa de corrección de pruebas, garantizando la correcta organización de los archivos finales (ver sección <a href="#sec-folders">Organización de carpetas de trabajo</a>).</li>
<li>los metadatos de los autores, el artículo y el volumen/número al que corresponde el dicho artículo (ver sección <a href="#sec-metadata">Metadatos</a>).</li>
<li>Generar los documentos finales con el paquete <code>{guri}</code>. <!-- (b) Incorporar un archivo (`XLSX`) enviado por el/los autores con la información de acreditación según la taxonomía [CRediT](https://credit.niso.org/) (ver sección [Metadatos](#sec-metadata)). --> <!-- (c) Garantizar que dichos metadatos queden correctamente representados en el sistema de gestión de revistas ([*Open Journal System - OJS*](https://pkp.sfu.ca/software/ojs/) o el gestor de portales de revistas utilizado). --> <!-- (e) Mediar en el intercambio con el resto del equipo editorial, en particular con los encargados de la comunicación con los autores para poder validar los documentos resultantes de este proceso antes de que pasen a la etapa siguiente. --></li>
</ol>
<p>Además, como parte de las tareas del Coordinador de producción, se espera que coordine la preparación y corrección de los manuscritos (ver sección <a href="articles/proofreading.html">Corrección de pruebas</a>). En esta guía se describen los pasos necesarios para la organización de carpetas de trabajo, la generación de metadatos y la generación de los documentos finales a partir de un manuscrito.</p>
</section>
<section id="sec-folders" class="level1">
<h1>Organización de carpetas de trabajo</h1>
<!-- # Preparación de un número de la revista -->
<p>Dentro de la carpeta de la revista usted puede generar un nuevo número creando una carpeta con el número correspondiente. No existen reglas específicas para nombrar los números, sin embargo, es recomendable que utilice un prefijo común y un número que le permita que sus documentos se ordenen naturalmente en su carpeta de trabajo. Por ejemplo, si su revista utiliza volúmenes y números, podría utilizar como nombre para la carpeta <code>vol[~]issue[~]</code> (por ejemplo, <code>vol02issue03</code> para el volumen 2, número 3). De igual manera, puede utilizar cualquier otra forma de numeración, pero teniendo en cuenta que la carpeta con los números de la revista deben estar alojados en la carpeta principal de la revista (no anidando carpetas). <!-- # Organización de carpetas de trabajo {#sec-folders} --></p>
<p>Para cada número se creará una carpeta independiente que contendrá un archivo <code>_issue.yaml</code> con la información básica del número. Dentro de esta carpeta se deberá generar una carpeta independiente para cada artículo. Las carpetas de cada artículo deben utilizar una estructura de prefijos común, de manera que empiecen por la sílaba ‘<code>art</code>’, seguida de un identificador de un dígito para la sección y dos dígitos que identifiquen a los artículos en un orden secuencial que se espera sean presentados (ver recuadro con ejemplo). En caso de que la revista no tenga sección podrá usar una numeración continuada con tres dígitos.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Ejemplo de nombre de carpetas para revista QUID16
</div>
</div>
<div class="callout-body-container callout-body">
<p>En la revista <em>Quid16</em> las secciones disponibles y sus respectivos números de referencia son:</p>
<ol type="1">
<li>Editorial;</li>
<li>Presentación de dossier o número especial;</li>
<li>Artículos del dossier;</li>
<li>Artículos de sección abierta;</li>
<li>Urbanidades;</li>
<li>Novedades;</li>
<li>Avisos editoriales.</li>
</ol>
<p>De esta manera, suponiendo que nuestro artículo pertenezca al Dossier (<code>3</code>) y sea el segundo en orden dentro de esta sección (<code>02</code>), el nombre de la carpeta sería <code>art302</code>.</p>
</div>
</div>
<p>Dentro de cada carpeta de artículo es obligatorio que haya los siguientes archivos:</p>
<ul>
<li><code>art[~].yaml</code> (ejemplo: <code>art302.yaml</code>): Contiene los metadatos del artículo (autores, el título, el resumen, etc).</li>
<li><code>art[~].docx</code> (ejemplo: <code>art302.docx</code>): Contiene el manuscrito corregido, con las referencias identificadas mediante gestor de referencia (si las hubiere).</li>
</ul>
<p>Además de estos archivos es posible encontrar uno o más de los siguientes archivos opcionales:</p>
<ul>
<li><code>art[~]_credit.xlsx</code> (ejemplo: <code>art302_credit.yaml</code>): Contiene una tabla con la información sobre la taxonomía CRediT, referida a las contribuciones de los autores individuales.</li>
<li><code>art[~]_app[~].docx</code>(ejemplo: <code>art302_app01.docx</code>): Contiene los anexos vinculados al manuscrito. Es posible que exista uno o más archivos de este tipo (dependiendo de la cantidad de anexos). Debería estar presente sólo si existen anexos en el manuscrito.</li>
<li><code>art[~]_notes.md</code> (ejemplo: <code>art302_notes.md</code>): En este archivo se podrá incluir cualquier tipo de observación o comentario que se considere pertinente comunicar. El archivo está en formato <a href="https://es.wikipedia.org/wiki/Markdown">Markdown</a>, por lo que se recomienda el uso de los marcadores asociados a este lenguaje de marcación (ver <a href="https://tutorialmarkdown.com/sintaxis">Tutorial de Markdown</a> y <a href="https://markdownlivepreview.com/">Editor online</a>). Recuerde que este archivo es simplemente un archivo de texto plano (por ejemplo un <code>.txt</code>) con una extención <code>.md</code>. Sólo puede haber un archivo de este tipo por artículo. El archivo sólo estará presente si hay comentarios durante el proceso de corrección de pruebas.</li>
</ul>
<!--# `art[~]_biblio.json` (ejemplo: `art302_biblio.json`): Contiene el listado bibliográfico en el formato estandarizado JSON (exportado desde Zotero). Sólo podrá haber un archivo `.JSON` por cada artículo y el mismo estará disponible sólo si el artículo tiene referencias bibliográficas asociadas. -->
<p>Además de estos archivos, dentro de cada carpeta de artículo podrá haber una carpeta <code>./float</code> con varios archivos en donde estarán las Tablas y Figuras (ver sección <a href="#sec-float">Elementos flotantes</a> para mayor desarrollo).</p>
<p>Para ilustrar la organización de archivos prevista, si el artículo que se está corrigiendo corresponde al <code>Número 20</code> de la revista, entonces la carpeta del segundo artículo de la sección “3” (<code>./art302</code>) deberá tener la estructura de archivos que se presenta en la <a href="#fig-folder" class="quarto-xref">Figura&nbsp;1</a>.</p>
<div id="fig-folder" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-folder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../figures/tree.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-folder-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;1: Estructura de carpetas y achivos.
</figcaption>
</figure>
</div>
</section>
<section id="sec-metadata" class="level1">
<h1>Metadatos</h1>
<section id="información-del-volumennúmero-el-archivo-_issue.yaml" class="level2">
<h2 class="anchored" data-anchor-id="información-del-volumennúmero-el-archivo-_issue.yaml">Información del volumen/número: el archivo <code>_issue.yaml</code></h2>
<blockquote class="blockquote">
<p><strong>[TODO]</strong> El archivo <code>issue.yaml</code>.</p>
</blockquote>
<p>Para la identifiación de los metadatos del número y el artículo se utilizará como modelo el documento <code>_issue.yaml</code> y <code>_article.yaml</code>, respectivamente (ver carpeta <code>./default-files</code>).</p>
<p>La instalación y configuración general se explica en el Anexo 1</p>
</section>
<section id="taxonomía-credit" class="level2">
<h2 class="anchored" data-anchor-id="taxonomía-credit">Taxonomía CRediT</h2>
<!-- El autor remitente es responsable de que las contribuciones de todos los autores sean correctas. Se espera que todos los autores hayan revisado, discutido y acordado sus contribuciones individuales tal y como las comparte el autor remitente. La declaración de contribución de los autores se publicará con el artículo final y debe reflejar fielmente las contribuciones al trabajo.

Cualquier colaborador con funciones que no representen una contribución sustancial (p. ej., Supervisión, Adquisición de fondos o Curación de datos) debe incluirse en los Agradecimientos.

Cualquier otro rol que no esté considerado en los roles anteriores deberá ser considerado en agradecimientos. -->
<p>Si la revista utiliza la <a href="https://credit.niso.org/">taxonomía CRediT</a> para identificar la contribución de los autores, entonces deberá proporcioanrse para cada artículo un archivo <code>art[~]_credit.xlsx</code>. Este archivo, deberá tener una primera columna (‘CREDIT’) con los catorces roles identificados por esta taxonomía[^1] y una columna para cada autor (vea el modelo disponible en la carpeta <code>./default-files</code>). Para indicar la contribución de cada autor deberá agregar una ‘x’ (equis minúscula). Es importante que esta tabla no contenga columnas que no referencien a los autores (no deje las columnas de la plantilla en blanco). Por el momento, no es posible utilizar una escala de contribución para cada uno de los roles. Tenga en cuenta que autor puede haber contribuido en más de uno de los roles. El programa no corrobora si las contribuciones atribuidas a cada autor se consideran sustanciales y suficientes para generar atribución de autoría.</p>
</section>
<section id="la-información-de-los-artículos-el-archivo-art.yaml" class="level2">
<h2 class="anchored" data-anchor-id="la-información-de-los-artículos-el-archivo-art.yaml">La información de los artículos: el archivo <code>art[~].yaml</code></h2>
<blockquote class="blockquote">
<p><strong>[TODO]</strong> Desarrollar la descripción de los elementos a completar en <code>art[~].yaml</code>.</p>
</blockquote>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>